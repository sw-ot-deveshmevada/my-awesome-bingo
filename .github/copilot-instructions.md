# Copilot Instructions for My Awesome Bingo

## Project Overview
**Soc Ops** is an interactive React + TypeScript + Tailwind v4 bingo game for in-person mixers. Players tap squares when they find people matching the question on each square. First to complete 5 in a row (rows, columns, or diagonals) wins. The center square is a free space.

## Architecture & Data Flow

### Core Layers
- **UI Components** (`src/components/`): Stateless or presentation-focused (BingoBoard, BingoSquare, GameScreen, StartScreen, BingoModal)
- **Game Logic** (`src/utils/bingoLogic.ts`): Pure functions for board generation, win detection, and state mutations
- **State Management** (`src/hooks/useBingoGame.ts`): Custom hook managing game state, localStorage persistence, and validation
- **Data** (`src/data/questions.ts`): 24 bingo questions + a free space constant

### Types & Domain Model
See `src/types/index.ts`:
- `BingoSquareData`: {id, text, isMarked, isFreeSpace}
- `BingoLine`: win detection (type, index, squares array)
- `GameState`: 'start' | 'playing' | 'bingo'

### Game State Lifecycle
1. **Start**: StartScreen → player clicks "New Game"
2. **Playing**: GameScreen displays shuffled 5×5 board → player taps squares
3. **Bingo**: Modal appears when 5-in-a-row detected → player can reset to 'start'

### Board Generation (`generateBoard()`)
- Shuffles 24 questions randomly (Fisher-Yates)
- Places FREE_SPACE at center (index 12, row 2 col 2)
- Center square is pre-marked and untabbable

## Persistence & Validation
- **localStorage Key**: 'bingo-game-state' (version 1)
- **Validation**: Strict type-checking in `useBingoGame.ts` — board must be 25 squares, gameState must match enum, all required fields present
- **Fallback**: Invalid data triggers new game state reset

## Key Conventions & Patterns

### Win Detection
- `checkBingo(board)`: Returns first matching BingoLine or null
- `getWinningSquareIds(winningLine)`: Returns Set<number> of highlighted squares
- Checks all 5 rows, 5 columns, 2 diagonals (12 total combinations)

### Component Props
- Components receive primitive values + callbacks, not full app state (e.g., GameScreen gets `hasBingo: boolean` and `onSquareClick` callback, not the full useBingoGame hook)
- This enables easy testing and component reuse

### Styling
- Tailwind v4 via `@tailwindcss/vite` plugin
- `src/index.css` imports Tailwind directives
- Mobile-first responsive design (buttons, text sizing for touch)

## Development Commands
- `npm run dev`: Start Vite dev server (http://localhost:5173), hot-reloads on file changes
- `npm run build`: TypeScript check + Vite build (output to dist/)
- `npm run lint`: ESLint check (catches unused vars, missing awaits, React hooks rules)
- `npm run test`: Vitest unit test runner

## Testing Patterns
- `src/utils/bingoLogic.test.ts`: Pure function tests (board generation, win detection)
- Tests are co-located with source files (`.test.ts` suffix)
- Use vitest + jsdom + @testing-library/react

## Adding New Features
- **New Questions**: Add strings to `src/data/questions.ts` (must be ≤24 total for random selection)
- **New Game Mode**: 
  1. Extend `GameState` type in `src/types/index.ts`
  2. Add mode UI component in `src/components/`
  3. Update `useBingoGame.ts` to handle new state transitions
  4. Ensure localStorage validation handles new gameState value
- **Component Changes**: Update props interface + reflect in parent call sites (use lint check to catch)

## Common Gotchas
1. **Board Mutations**: bingoLogic.ts always returns NEW arrays (immutable) — never mutate board directly
2. **Free Space**: Center square (index 12) cannot be toggled; `toggleSquare()` explicitly checks `isFreeSpace`
3. **Win Detection**: Only checks marked squares; free space is pre-marked but doesn't auto-win on diagonal
4. **localStorage**: Always validate before use; corrupt data silently resets to start state

## Deployment
- GitHub Pages: Automatic on push to `main` (GitHub Actions workflow)
- Build output: `dist/` directory (generated by `npm run build`)

## Useful File Quick Reference
| File | Purpose |
|------|---------|
| `src/hooks/useBingoGame.ts` | Core game state logic & persistence |
| `src/utils/bingoLogic.ts` | Board generation, win detection (pure functions) |
| `src/components/GameScreen.tsx` | Main game UI |
| `src/types/index.ts` | TypeScript domain types |
| `src/data/questions.ts` | Bingo questions list |
| `vite.config.ts` | Build config (Tailwind v4, React plugin) |

